# Excel


## マクロ

### Excelの基礎

|  要素名|  オブジェクト名|
|---|---|
|アプリケーション|Application|
|アプリケーション|Application|
|ブック|Workbook|
|ワークシート|Worksheet|
|セル|Range|

### 関数

##### 項目を一意にする関数(C2～を一意にする)

~~~
C2&IF(COUNTIF($C$2:C2,C2)=0,"",COUNTIF($C$2:C2,C2))
~~~

### キーボードショートカット

* Alt,E,S,V で値貼り付け
* Alt,E,I,S でオートフィル
* Alt+↓ 候補を表示する（入力補完をプルダウンで実施する）

## Tips


### セルの結合を解除したとき全てのセルに同じ値を表示させる

◯結合セルが複数の場合（連続していること）


1. 結合セル範囲を全て選択
1. 結合解除のあと、セル範囲が選択状態のまま
1. Ctrl+G　「ジャンプ」ダイアログ表示
1. 「セル選択」から「選択オプション」ダイアログ表示
1. 「空白セル」オプションを選択
1. アクティブセルに対象のセル参照式を入力(F2->=A1等)
1. 数式を確定せず編集モードのままCtrl＋Enter　（他の空白セルに参照式をフィル入力）

数式のままでなく値にするなら再度対象セル範囲を選択しコピーし「形式を選択して貼り付け」の「値」で貼り付け



### 特定文字の色変更

~~~
Sub Macro1()
Dim rng As Range
Dim ptr As Integer
Const tStr As String = "ABC" 'ここに色を変える文字列を書く
　For Each rng In ActiveSheet.Cells.SpecialCells(xlCellTypeConstants, 23)
　　ptr = InStr(rng.Value, tStr)
　　If ptr > 0 Then
　　　rng.Characters(Start:=ptr, Length:=Len(tStr)).Font.ColorIndex = 3
　　End If
　Next rng
End Sub
~~~



### 書式設定で0のときに表示しない

ユーザー定義書式では「;」（セミコロン）で区切りながら、

　正の値

　負の値

　「0」（ゼロ）

　文字列

の表示形式をそれぞれ指定できます


### 新しいウィンドウで開く

~~~
Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOTExcel.Sheet.12shell]
@="OpenNewWindow"
[HKEY_CLASSES_ROOTExcel.Sheet.8shell]
@="OpenNewWindow"
~~~

### フィルタリングした結果をコピーしたい

1. フィルタリングした結果コピーしたい領域を選択する
1. Ctrl+gでジャンプする
1. セル選択
1. 可視セルを選択
1. OK
1. コピーする

### あるセルが特定の値と一致した場合、行全体の色を変更する方法

1. 条件付き書式を選択
1. 新しいルールの作成
1. 数式を使用して、書式設定するセルを決定
1. ="条件のあるセル"="条件の値"
1. 書式ボタン->一致したときの色
1. OKボタン
1. 適用先->=$"色を塗りたい列始まり"$"色を塗りたい列終わり"
1. 適用

## FAQ

### 可視セルのみに貼り付ける

フィルタリングされていると可視セルのみに貼り付けられない


まずは、捨て列に連続データを作る

0. 先頭のデータに1を入力する

1. フィルタを実行して、先頭のセルに連番の初期値を入力してから、範囲選択して、ショートカットキー［Alt］＋［;］（セミコロン）で可視セルを選択しておきます。

2. そのあと、フィルタを解除するのがポイントです。

3. フィルタを解除してしまえば［ホーム］タブ−［編集］グループ−［フィル］−［連続データの作成］コマンドが使えるようになりますから、［連続データ］ダイアログで連番を振ればいいということです。

4. その後、該当セルにてINDIRECT("対象シート"&捨てセル)とする




### 非表示設定なのになにも表示されないページが印刷される

通常非表示の場合は、印刷されない。

しかし、印刷の表示枠を固定しているとその部分は勝手に印刷されてしまう。

印刷範囲の太い青い枠を印刷範囲上段までひっぱりすべて点線にすると非表示が印刷されなくなる。



### 先頭行が非表示でもないのに表示されない。

先頭行にてウィンドウの固定がされている。固定を解除すればよい。


### ダブルクリックすると変な位置に選択領域が移動する

「Excelのオプション」→「詳細設定」→「フィルハンドルおよびセルのドラッグ アンド ドロップを使用する」のチェックを外す。


http://una.soragoto.net/tips/21.html

